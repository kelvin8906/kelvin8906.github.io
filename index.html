<!DOCTYPE html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.0//EN" "http://www.wapforum.org/DTD/xhtml-mobile10.dtd">
<html>
  <head>
    <meta charset="utf-8">
    <title>中信银行信用卡</title>
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <meta content="telephone=no" name="format-detection" />
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <style>
    #container {
        width: 100%
    }
    </style>
  </head>
  
<body>
<input id="fileselect" type="file" accept="image/*" capture="camera">
<div id="container">
    <video autoplay="" id="videoElement">
     
    </video>
</div>

<canvas id="canvas" width="500" height="375"></canvas>
<input type="button" value="Save" id="save">

<img id="imgtag" src="" width="500" height="375" alt="capture">
<script>
var video = document.querySelector("#videoElement");
 
if(navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
    // Not adding `{ audio: true }` since we only want video now
    navigator.mediaDevices.getUserMedia({ video: true }).then(function(stream) {
        video.src = window.URL.createObjectURL(stream);
        video.play();
    });
} else if(navigator.getUserMedia) { // Standard
    navigator.getUserMedia({ video: true }, function(stream) {
        video.src = stream;
        video.play();
    }, errBack);
} else if(navigator.webkitGetUserMedia) { // WebKit-prefixed
    navigator.webkitGetUserMedia({ video: true }, function(stream){
        video.src = window.webkitURL.createObjectURL(stream);
        video.play();
    }, errBack);
} else if(navigator.mozGetUserMedia) { // Mozilla-prefixed
    navigator.mozGetUserMedia({ video: true }, function(stream){
        video.src = window.URL.createObjectURL(stream);
        video.play();
    }, errBack);
} else {
    alert('no device found')
}

function errBack(e) {
    console.log(e)
}

document.addEventListener('DOMContentLoaded', function(){
    v = document.getElementById('videoElement');
    canvas = document.getElementById('canvas');
    context = canvas.getContext('2d');
	w = canvas.width;
    h = canvas.height;

},false);

function draw(v,c,w,h) {
    if(v.paused || v.ended) return false;
    context.drawImage(v,0,0,w,h);
   
   var uri = canvas.toDataURL("image/png");
   
  // console.log(uri);
   
   imgtag.src = uri;
}

document.getElementById('save').addEventListener('click',function(e){
	
	draw(v,context,w,h);
	
	
});
</script>

</body></html>